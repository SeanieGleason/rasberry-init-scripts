version: '3.8'

services:
  dreampi:
    # Build the image from the Dockerfile in the current directory
    build:
      context: .
      dockerfile: Dockerfile

    # Required for low-level network manipulation
    cap_add:
      - NET_ADMIN
      - NET_RAW

    # Use the host's network stack for gateway functionality
    network_mode: "host"

    # --- IMPORTANT: ADD THIS SECTION FOR MODEM ACCESS ---
    # You MUST replace '/dev/ttyACM0' with the actual device path of your USB modem
    # and map it into the container (e.g., to the same path).
    devices:
      - "/dev/ttyACM0:/dev/ttyACM0"
      # If you are unsure of the path, you can try mounting the whole /dev directory
      # (less secure, but sometimes easier for device discovery):
      # - "/dev:/dev"
      # --- END IMPORTANT SECTION ---

    # Restart policy to ensure it keeps running
    restart: always